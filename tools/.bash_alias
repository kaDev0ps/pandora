# Basic commands
alias up='uptime -p'                                            # Show system uptime in a human-readable format
alias scat='sudo cat -n'                                        # Open cat with line numbers for root
alias c='clear'                                                 # Clear the terminal screen
alias ipa='ip -br -c a'                                         # Show network interfaces and IP
alias ll='ls -lh'                                               # List files with human-readable sizes
alias lo='locate'                                               # Find files by name using the locate database
alias df='df -h'                                                # Show disk space usage in human-readable format
alias ..='cd ..'                                                # Go up one directory
alias lsd='lsd -lh --icon=never'                                # List files with human-readable sizes without icons
alias la='ls -lah --color=auto'                                 # List all files including hidden ones with color
alias lscpu='sudo lscpu'                                        # Check all info about CPU
alias mkdir='mkdir -pv'                                         # Create directories and show the progress
alias svim='sudo vim'                                           # Open vim with line numbers for root
alias psg='ps aux | grep'                                       # Search for a process by name
alias vs='sudo visudo'                                          # Launch visudo
alias r='ranger'                                                # Launch ranger
alias del='sudo rm -rf'                                         # Recursive delete with sudo
alias duse='du -ah --max-depth=1 $(pwd) | sort -rh | head -n 10' # Check size of files in the current directory
alias dlog='du -sh /var/log/* 2>/dev/null | sort -hr | head -n 10' # Check size of logs
alias ncdu='sudo ncdu'                                          # Show disk usage with ncdu
alias lsof='sudo lsof -i'                                       # Show services on my ports
alias gr="grep -Ev '^\s*#|^$'"                                  # Show file without comment and empty line
alias col='column -t -s'                                        # Column tail     Example: col ' ' or col ','
alias cutc='cut -c'                                             # Show short logs Example: cutc 1-200 

# Updates
## Display system information
alias mtr10='mtr -r -c 10'                                      # Run traceroute with 10 cycles
alias mtr100='mtr -r -c 100'                                    # Run traceroute with 100 cycles
alias sysinfo='uname -a; lsb_release -a'                        # Show system and versn info
alias update='sudo apt update'                                  # Update package lists
alias clean='sudo apt clean'                                    # Clean local repository of retrieved package files
alias autoremove='sudo apt autoremove -y'                       # Remove unnecessary packages automatically

# Monitoring
alias h='history'                                               # View command history
alias j='jobs -l'                                               # List current jobs
alias du='du -ch'                                               # Show disk usage of files and directories in human-readable format
alias ports='sudo ss -tulnp'                                    # Show open ports and listening sockets
alias myip='curl ifconfig.me'                                   # Get the external IP address

# Networking
alias dnstop='sudo dnstop -l 5'                                 # Monitor DNS traffic on interface                     Example: dnstop enp0s3
alias vnstat='sudo vnstat -i'                                   # View network traffic stats on interface              Example: vnstat enp0s3
alias iftop='sudo iftop -i'                                     # Display bandwidth usage on an interface              Example: iftop enp0s3
alias tcpdump='sudo tcpdump -i'                                 # Capture packet data on the specified interface       Example: tcpdump enp0s3
alias connections='ss -tan | awk "/ESTAB/ {print \$5}" | cut -d: -f1 | sort | uniq -c | sort -nr | head -10'
                                                                # Show  active connections from host                   Example: connections
# Systemctl
alias sss='sudo systemctl stop'                                 # Stop a systemd service
alias ssr='sudo systemctl restart'                              # Restart a systemd service
alias sse='sudo systemctl enable'                               # Enable a systemd service to start on boot
alias ssd='sudo systemctl disable'                              # Disable a systemd service from starting on boot
alias ssc='sudo systemctl cat'                                  # Show the contents of a systemd service file
alias ssi='sudo systemctl status'                               # Check the status of a systemd service
alias slu='sudo systemctl list-units --type=service'            # List all systemd services
alias sdr='sudo systemctl daemon-reload'                        # Reload systemctl
alias srr='sudo systemctl reset-failed'                         # Reset systemctl failed state
alias edit='sudo systemctl edit'                                # Edit systemd units
alias scg='systemd-cgtop -d 5'                                  # Show more loaded services

# Journalctl
# View system logs
alias logs='sudo journalctl -xe'                                # Show recent logs with detailed error messages
alias jfeu='sudo journalctl -n 20 -feu'                         # Sjow 20 last line and new logs

# Clean system logs
alias clearlogs='sudo journalctl --vacuum-time=1d'              # Remove logs older than 1 day

# Archiving
# Create a tar.gz archive
alias taz='tar -czvf'                                           # Create a compressed tarball

# Extract a tar.gz archive
alias untaz='tar -xzvf'                                         # Extract a compressed tarball

# Tools
alias iot='sudo iotop -oPa'                                     # TOP processes that actively use the disk (I/O)
alias ios='iostat  -mpxz'                                       # Information on disk usage
alias pssh="parallel-ssh"                                       # Parallel SSH command execution
alias pssc="parallel-scp"                                       # Parallel file copy
alias fd="fdfind"                                               # Find files in OS

# GIT
alias gitp='gitc && git push'                                   # Commit and push to remote repo

# Load Balancer
alias nt='sudo nginx -t'                                        # Test nginx config
alias at='sudo angie -t'                                        # Test angie config
alias srn='sudo systemctl reload nginx'                         # Reload nginx service
alias sra='sudo systemctl reload angie'                         # Reload angie service

# Environment
alias envr="source ~/ranger-env/bin/activate"                   # Activate ranger virtual environment
alias envs="deactivate"                                         # Deactivate virtual environment

# Exports
export HISTTIMEFORMAT="%d.%m.20%y %T "                          # Timestamp format in history
export EDITOR=vim
HIST_STAMPS="%F %T"

# N3. Netrika
alias n3='for UNIT in $(systemctl list-unit-files "r*.service" --type=service --no-legend | awk "{print \$1}"); do PORT=$(systemctl show "$UNIT" --property=Environment | grep -oP "(?<=:)\d+"); if [ -n "$PORT" ]; then echo "$PORT $UNIT"; fi; done'

# Functions
gitc() {
  git add . && git commit -m "$(date '+%Y-%m-%d %H:%M:%S')" || echo "Git commit failed"
}
info() {
    echo "USER PID %CPU %MEM COMMAND"; sudo ps -eo user,pid,%cpu,%mem,command --no-headers | sort -nr -k 3 | head -10
}

### DOCKER ###
# User and access management
alias adduserd='sudo usermod -aG docker $USER'                   # Add user to "docker" group (run once, then re-login).

# Core Status & Inspect
alias d='docker'                          # Example: d ps
alias dps='docker ps'                     # Example: dps
alias dpa='docker ps -a'                  # Example: dpa
alias dpsq='docker ps -q'                 # Example: dpsq
alias dls='docker ps -l -q'               # Example: dls
alias di='docker images -a'               # Example: di
alias diq='docker images -q'              # Example: diq
alias dins='docker inspect'               # Example: dins myapp
alias diins='docker image inspect'        # Example: diins nginx:alpine
alias dv='docker version'                 # Example: dv
alias dinfo='docker system info'          # Example: dinfo
alias ddf='docker system df'              # Example: ddf
alias dstats='docker stats'               # Example: dstats (or dstats myapp)
alias devents='docker system events'      # Example: devents
alias ddisk='df -h /var/lib/docker'       # Example: ddisk
alias ddaemon='cat /etc/docker/daemon.json'  # Example: ddaemon
alias djfeuc='sudo journalctl -feu containerd'                            # Example: dfeuc
alias djfeud='sudo journalctl -feu docker'                                # Example: dfeud

# Build & Images
alias db='docker build -t'                # Example: db myapp:v1 .
alias dbc='docker build --no-cache -t'    # Example: dbc myapp:debug .
alias dbf='docker build -f -t'            # Example: dbf Dockerfile.prod -t myapp:prod .
alias dph='docker pull'                   # Example: dph nginx:alpine
alias drs='docker search'                 # Example: drs postgres
alias dih='docker image history'          # Example: dih nginx:alpine
alias drmi='docker rmi'                   # Example: drmi myapp:v1


# Run & Exec (Safe defaults)
alias drun='docker run -it --rm'          # Example: drun nginx:alpine bash
alias drund='docker run -d --rm'          # Example: drund nginx:alpine
alias drp='docker run -d -p --rm'         # Example: drp 8080:80 nginx:alpine
alias drP='docker run -d -P --rm'         # Example: drP nginx:alpine
alias dex='docker exec -it'               # Example: dex myapp bash
alias dsh='docker exec -it $(docker ps -lq) sh || docker exec -it $(docker ps -lq) bash'  # Example: dsh (uses last cont)
alias datt='docker attach'                # Example: datt myapp

# Control & Lifecycle
alias dlogs='docker logs -f --tail 100'   # Example: dlogs myapp
alias dstop='docker stop'                 # Example: dstop myapp
alias dkill='docker kill'                 # Example: dkill myapp
alias drst='docker restart'               # Example: drst myapp
alias dstart='docker start'               # Example: dstart myapp
alias drm='docker rm -f'                  # Example: drm myapp (or dpsq | xargs drm)
alias drename='docker rename'             # Example: drename oldname newname
alias dcp='docker cp'                     # Example: dcp README.md myapp:/app/

# Cleanup (Progressive)
alias dcpr='docker container prune -f'    # Example: dcpr
alias dipr='docker image prune -a -f'     # Example: dipr
alias dvpr='docker volume prune -f'       # Example: dvpr
alias dnpr='docker network prune -f'      # Example: dnpr
alias dbpr='docker builder prune -a -f'   # Example: dbpr
alias dspr='docker system prune -a -f'    # Example: dspr
alias dsprv='docker system prune -a -f --volumes'  # Example: dsprv (⚠️ CAREFUL)

# Volumes
alias dvl='docker volume ls'              # Example: dvl
alias dvins='docker volume inspect'       # Example: dvins mydata
alias dvcr='docker volume create'         # Example: dvcr mydata
alias dvrm='docker volume rm'             # Example: dvrm mydata

# Docker Compose
alias dc='docker compose'                 # Example: dc ps
alias dcu='docker compose up -d'          # Example: dcu
alias dcub='docker compose up -d --build' # Example: dcub
alias dcd='docker compose down -v'        # Example: dcd
alias dcl='docker compose logs -f'        # Example: dcl
alias dcp='docker compose ps'             # Example: dcp
alias dce='docker compose exec'           # Example: dce web bash
alias dcb='docker compose build'          # Example: dcb
alias dcrm='docker compose rm -f'         # Example: dcrm
alias dcfg='docker compose config'        # Example: dcfg

# Swarm
alias dsi='docker swarm init'                # Example: dsi
alias dsjw='docker swarm join-token worker'  # Example: dsjw
alias dsjm='docker swarm join-token manager' # Example: dsjm
alias dsnl='docker node ls'                  # Example: dsnl
alias dsls='docker service ls'               # Example: dsls
alias dsdeploy='docker stack deploy --compose-file'  # Example: dsdeploy docker-compose.yml mystack
alias dsrm='docker stack rm'                 # Example: dsrm mystack

# Docker stack
alias dnls='docker node ls'                                      # Check my cluster docker compose                              Example: dnls
alias dsls='docker service ls'                                    # Check my services in cluster                                 Example: dsls
alias dsdeploy='docker stack deploy --compose-file'              # Deploy or update a stack using a compose file.               Example: dstackdeploy docker-compose.yml mystack
alias dsls='docker stack ls'                                     # List all stacks deployed in the swarm.                       Example: dstackls
alias dsservices='docker stack services'                         # List services running in a specific stack.                   Example: dstackservices mystack
alias dsps='docker stack ps'                                     # List all tasks (containers) in a stack with their status.    Example: dstackps mystack
alias dsrm='docker stack rm'                                     # Remove a stack and all its services.                         Example: dstackrm mystack
alias dslogs='docker service logs'                               # View logs for a specific service in a stack.                 Example: dservicelogs mystack_web
alias dsconfig='docker stack config'                             # Show the combined configuration of a stack.                  Example: dstackconfig mystack

# Additional scripts
## Run welcome script on SSH login
if [[ -n "$SSH_CONNECTION" ]]; then
  ~/tools/welcome.sh
fi
